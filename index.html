<!-- index.html -->

<!DOCTYPE html>
<html>
<head>
  <title>File Directory</title>
  <style>
    ul {
      list-style-type: none;
      padding: 0;
    }
    li {
      margin-bottom: 10px;
    }
  </style>
  <script>
    function showDirectory(path) {
      const apiUrl = `https://api.github.com/repos/wangchunin/SHELL/contents${path}`;

      fetch(apiUrl)
        .then(response => {
          if (!response.ok) {
            throw new Error('Failed to fetch directory');
          }
          return response.json();
        })
        .then(data => {
          const container = document.getElementById('container');
          container.innerHTML = '';

          const title = document.createElement('h1');
          title.textContent = 'Directory';
          container.appendChild(title);

          const ul = document.createElement('ul');
          container.appendChild(ul);

          if (path !== '/') {
            const li = document.createElement('li');
            ul.appendChild(li);

            const link = document.createElement('a');
            link.textContent = 'Go Back';
            link.href = '..';
            link.addEventListener('click', event => {
              event.preventDefault();
              showDirectory(getParentPath(path));
            });
            li.appendChild(link);
          }

          data.forEach(item => {
            const li = document.createElement('li');
            ul.appendChild(li);

            const itemName = item.name;
            const itemPath = item.path;
            const isDirectory = item.type === 'dir';

            if (isDirectory) {
              const link = document.createElement('a');
              link.textContent = itemName;
              link.href = itemPath;
              link.addEventListener('click', event => {
                event.preventDefault();
                showDirectory(itemPath);
              });
              li.appendChild(link);
            } else {
              const link = document.createElement('a');
              link.textContent = itemName;
              link.href = itemPath;
              link.target = '_blank';
              li.appendChild(link);
            }
          });
        })
        .catch(error => {
          console.error(error);
        });
    }

    function getParentPath(path) {
      const parts = path.split('/');
      parts.pop();
      return parts.join('/') || '/';
    }

    showDirectory('/');
  </script>
</head>
<body>
  <div id="container"></div>
</body>
</html>
